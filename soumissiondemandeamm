<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>e-Homologation DPML - Syst√®me Interactif</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel Standalone for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fade-in 0.3s ease-out;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Icon Components (simplified Lucide icons)
        const Icon = ({ name, className = "w-4 h-4" }) => {
            useEffect(() => {
                lucide.createIcons();
            }, []);
            return <i data-lucide={name} className={className}></i>;
        };

        const EHomologationDPML = () => {
            const [activeView, setActiveView] = useState('secretariat');
            const [showNewDemandModal, setShowNewDemandModal] = useState(false);
            const [showDetailModal, setShowDetailModal] = useState(false);
            const [showARUploadModal, setShowARUploadModal] = useState(false);
            const [selectedApplication, setSelectedApplication] = useState(null);
            const [notification, setNotification] = useState(null);
            const [uploadedFiles, setUploadedFiles] = useState([]);
            const [arFile, setArFile] = useState(null);
            
            const [applications, setApplications] = useState([
                {
                    id: 1,
                    ammNumber: 'AMM-2024-001',
                    type: 'Nouvelle AMM',
                    dci: 'Parac√©tamol',
                    formePharm: 'Comprim√©',
                    dosage: '500mg',
                    nomCommercial: 'Panadol',
                    fabricant: 'GSK',
                    paysOrigine: 'Royaume-Uni',
                    pght: 1200,
                    status: 'Approuv√©',
                    dateSubmission: '2024-09-15',
                    dateAR: '2024-09-20',
                    arDocument: 'AR-AMM-2024-001.pdf',
                    representative: 'Dr. Kamga Jean-Pierre',
                    company: 'PharmaPlus',
                    email: 'j.kamga@pharmaplus.cm',
                    documents: 7,
                    documentsVerified: 7
                },
                {
                    id: 2,
                    ammNumber: 'AMM-2024-002',
                    type: 'Renouvellement',
                    dci: 'Amoxicilline',
                    formePharm: 'G√©lule',
                    dosage: '250mg',
                    nomCommercial: 'Amoxil',
                    fabricant: 'Sandoz',
                    paysOrigine: 'Suisse',
                    pght: 2500,
                    status: 'Commission CNM',
                    dateSubmission: '2024-10-01',
                    dateAR: '2024-10-05',
                    arDocument: 'AR-AMM-2024-002.pdf',
                    representative: 'Dr. Ngo Bih Marie',
                    company: 'MediPharm',
                    email: 'm.ngobih@medipharm.cm',
                    documents: 7,
                    documentsVerified: 7
                },
                {
                    id: 3,
                    ammNumber: 'AMM-2024-003',
                    type: 'Nouvelle AMM',
                    dci: 'M√©tronidazole',
                    formePharm: 'Solution injectable',
                    dosage: '500mg/100ml',
                    nomCommercial: 'Flagyl IV',
                    fabricant: 'Sanofi',
                    paysOrigine: 'France',
                    pght: 3800,
                    status: 'V√©rification en cours',
                    dateSubmission: '2024-10-20',
                    dateAR: '2024-10-25',
                    arDocument: 'AR-AMM-2024-003.pdf',
                    representative: 'Dr. Fouda Bernard',
                    company: 'Global Health',
                    email: 'b.fouda@globalhealth.cm',
                    documents: 6,
                    documentsVerified: 4
                },
                {
                    id: 4,
                    ammNumber: 'AMM-2024-004',
                    type: 'Variation Majeure',
                    dci: 'Ibuprof√®ne',
                    formePharm: 'Suspension',
                    dosage: '100mg/5ml',
                    nomCommercial: 'Nurofen Junior',
                    fabricant: 'Reckitt Benckiser',
                    paysOrigine: 'Royaume-Uni',
                    pght: 2200,
                    status: 'En attente AR',
                    dateSubmission: '2024-11-05',
                    dateAR: null,
                    arDocument: null,
                    representative: 'Dr. Atangana Sophie',
                    company: 'AfriPharma',
                    email: 's.atangana@afripharma.cm',
                    documents: 7,
                    documentsVerified: 7
                },
                {
                    id: 5,
                    ammNumber: 'AMM-2024-005',
                    type: 'Nouvelle AMM',
                    dci: 'Ciprofloxacine',
                    formePharm: 'Comprim√©',
                    dosage: '500mg',
                    nomCommercial: 'Cipro',
                    fabricant: 'Bayer',
                    paysOrigine: 'Allemagne',
                    pght: 4500,
                    status: 'Soumis',
                    dateSubmission: '2024-11-28',
                    dateAR: null,
                    arDocument: null,
                    representative: 'Dr. Kamga Jean-Pierre',
                    company: 'PharmaPlus',
                    email: 'j.kamga@pharmaplus.cm',
                    documents: 7,
                    documentsVerified: 0
                },
                {
                    id: 6,
                    ammNumber: 'AMM-2024-006',
                    type: 'Nouvelle AMM',
                    dci: 'Om√©prazole',
                    formePharm: 'G√©lule',
                    dosage: '20mg',
                    nomCommercial: 'Mopral',
                    fabricant: 'AstraZeneca',
                    paysOrigine: 'Su√®de',
                    pght: 3200,
                    status: 'Approuv√©',
                    dateSubmission: '2024-09-10',
                    dateAR: '2024-09-15',
                    arDocument: 'AR-AMM-2024-006.pdf',
                    representative: 'Dr. Ngo Bih Marie',
                    company: 'MediPharm',
                    email: 'm.ngobih@medipharm.cm',
                    documents: 7,
                    documentsVerified: 7
                },
                {
                    id: 7,
                    ammNumber: 'AMM-2024-007',
                    type: 'Renouvellement',
                    dci: 'Parac√©tamol',
                    formePharm: 'Sirop',
                    dosage: '120mg/5ml',
                    nomCommercial: 'Doliprane Sirop',
                    fabricant: 'Sanofi',
                    paysOrigine: 'France',
                    pght: 1800,
                    status: 'Rejet√©',
                    dateSubmission: '2024-10-15',
                    dateAR: '2024-10-20',
                    arDocument: 'AR-AMM-2024-007.pdf',
                    representative: 'Dr. Fouda Bernard',
                    company: 'Global Health',
                    email: 'b.fouda@globalhealth.cm',
                    documents: 5,
                    documentsVerified: 5,
                    rejectionReason: 'Documents incomplets - Certificat d\'analyse manquant'
                },
                {
                    id: 8,
                    ammNumber: 'AMM-2024-008',
                    type: 'Nouvelle AMM',
                    dci: 'Azithromycine',
                    formePharm: 'Comprim√©',
                    dosage: '250mg',
                    nomCommercial: 'Zithromax',
                    fabricant: 'Pfizer',
                    paysOrigine: '√âtats-Unis',
                    pght: 5200,
                    status: 'V√©rification en cours',
                    dateSubmission: '2024-11-10',
                    dateAR: '2024-11-15',
                    arDocument: 'AR-AMM-2024-008.pdf',
                    representative: 'Dr. Atangana Sophie',
                    company: 'AfriPharma',
                    email: 's.atangana@afripharma.cm',
                    documents: 7,
                    documentsVerified: 5
                }
            ]);

            const [newDemand, setNewDemand] = useState({
                type: 'Nouvelle AMM',
                dci: '',
                formePharm: 'Comprim√©',
                dosage: '',
                nomCommercial: '',
                fabricant: '',
                paysOrigine: '',
                pght: ''
            });

            const statusColors = {
                'Approuv√©': 'bg-green-100 text-green-800 border-green-300',
                'En cours': 'bg-orange-100 text-orange-800 border-orange-300',
                'Soumis': 'bg-blue-100 text-blue-800 border-blue-300',
                'Rejet√©': 'bg-red-100 text-red-800 border-red-300',
                'V√©rification en cours': 'bg-yellow-100 text-yellow-800 border-yellow-300',
                'En attente AR': 'bg-purple-100 text-purple-800 border-purple-300',
                'Commission CNM': 'bg-indigo-100 text-indigo-800 border-indigo-300'
            };

            useEffect(() => {
                lucide.createIcons();
            }, [activeView, showNewDemandModal, showARUploadModal, showDetailModal, applications]);

            const showNotification = (message, type = 'success') => {
                setNotification({ message, type });
                setTimeout(() => setNotification(null), 4000);
            };

            const handleFileUpload = (e) => {
                const files = Array.from(e.target.files);
                setUploadedFiles(files);
                showNotification(`${files.length} document(s) t√©l√©vers√©(s) avec succ√®s`, 'success');
            };

            const handleARFileUpload = (e) => {
                const file = e.target.files[0];
                if (file && file.type === 'application/pdf') {
                    setArFile(file);
                    showNotification('AR t√©l√©vers√© avec succ√®s', 'success');
                } else {
                    showNotification('Veuillez t√©l√©verser un fichier PDF', 'error');
                }
            };

            const handleSubmitNewDemand = (e) => {
                e.preventDefault();
                
                if (!newDemand.dci || !newDemand.dosage || !newDemand.nomCommercial || !newDemand.fabricant || !newDemand.paysOrigine || !newDemand.pght) {
                    showNotification('Veuillez remplir tous les champs obligatoires', 'error');
                    return;
                }

                if (uploadedFiles.length === 0) {
                    showNotification('Veuillez t√©l√©verser les documents requis', 'error');
                    return;
                }

                const newAmmNumber = `AMM-2024-${String(applications.length + 1).padStart(3, '0')}`;
                const today = new Date().toISOString().split('T')[0];
                
                const newApplication = {
                    id: applications.length + 1,
                    ammNumber: newAmmNumber,
                    ...newDemand,
                    pght: parseFloat(newDemand.pght),
                    status: 'Soumis',
                    dateSubmission: today,
                    dateAR: null,
                    arDocument: null,
                    representative: 'Dr. Kamga Jean-Pierre',
                    company: 'PharmaPlus',
                    email: 'j.kamga@pharmaplus.cm',
                    documents: uploadedFiles.length,
                    documentsVerified: 0
                };

                setApplications([...applications, newApplication]);
                showNotification(`Demande soumise avec succ√®s! Num√©ro: ${newAmmNumber}`, 'success');
                
                setNewDemand({
                    type: 'Nouvelle AMM',
                    dci: '',
                    formePharm: 'Comprim√©',
                    dosage: '',
                    nomCommercial: '',
                    fabricant: '',
                    paysOrigine: '',
                    pght: ''
                });
                setUploadedFiles([]);
                setShowNewDemandModal(false);
            };

            const handleStatusChange = (appId, newStatus) => {
                setApplications(applications.map(app => 
                    app.id === appId ? { ...app, status: newStatus } : app
                ));
                showNotification(`Statut mis √† jour: ${newStatus}`, 'success');
                setShowDetailModal(false);
            };

            const handleUploadAR = (app) => {
                setSelectedApplication(app);
                setArFile(null);
                setShowARUploadModal(true);
            };

            const handleSubmitAR = () => {
                if (!arFile) {
                    showNotification('Veuillez t√©l√©verser le document AR (PDF)', 'error');
                    return;
                }

                const today = new Date().toISOString().split('T')[0];
                const arDocumentName = `AR-${selectedApplication.ammNumber}.pdf`;
                
                setApplications(applications.map(app => 
                    app.id === selectedApplication.id ? { 
                        ...app, 
                        dateAR: today, 
                        arDocument: arDocumentName,
                        status: 'V√©rification en cours' 
                    } : app
                ));
                
                showNotification(`AR t√©l√©vers√© et envoy√© √† ${selectedApplication.email}`, 'success');
                setShowARUploadModal(false);
                setArFile(null);
                setSelectedApplication(null);
            };

            const getApplicationsByStatus = (status) => {
                return applications.filter(app => app.status === status);
            };

            const currentUserApplications = applications.filter(app => 
                app.representative === 'Dr. Kamga Jean-Pierre'
            );

            const totalSubmitted = applications.length;
            const totalApproved = applications.filter(app => app.status === 'Approuv√©').length;
            const approvalRate = ((totalApproved / totalSubmitted) * 100).toFixed(1);
            const pending = applications.filter(app => 
                !['Approuv√©', 'Rejet√©'].includes(app.status)
            ).length;

            const statusCounts = {
                'Soumis': getApplicationsByStatus('Soumis').length,
                'V√©rification en cours': getApplicationsByStatus('V√©rification en cours').length,
                'En attente AR': getApplicationsByStatus('En attente AR').length,
                'Commission CNM': getApplicationsByStatus('Commission CNM').length,
                'Approuv√©': getApplicationsByStatus('Approuv√©').length,
                'Rejet√©': getApplicationsByStatus('Rejet√©').length
            };

            const dciAnalysis = {};
            applications.forEach(app => {
                if (!dciAnalysis[app.dci]) {
                    dciAnalysis[app.dci] = { count: 0, totalPGHT: 0, references: [] };
                }
                dciAnalysis[app.dci].count++;
                dciAnalysis[app.dci].totalPGHT += app.pght;
                dciAnalysis[app.dci].references.push(app.nomCommercial);
            });

            const marketAlerts = Object.entries(dciAnalysis).map(([dci, data]) => ({
                dci,
                references: data.count,
                avgPGHT: Math.round(data.totalPGHT / data.count),
                status: data.count >= 3 ? 'red' : data.count === 2 ? 'orange' : 'green'
            }));

            const ApplicationCard = ({ app, onView, onUploadAR, showARButton }) => {
                return (
                    <div className="bg-white rounded-lg border shadow-sm hover:shadow-md transition-all p-3">
                        <div className="flex items-start justify-between mb-2">
                            <div className="text-xs font-semibold text-blue-600">{app.ammNumber}</div>
                            <span className={`px-2 py-0.5 rounded text-xs font-medium border ${statusColors[app.status]}`}>
                                {app.status === 'V√©rification en cours' ? 'V√©rif.' : app.status}
                            </span>
                        </div>
                        <div className="space-y-1 mb-3">
                            <div className="font-medium text-sm text-gray-900">{app.representative}</div>
                            <div className="text-xs text-gray-600">{app.company}</div>
                            <div className="text-xs text-gray-900 font-medium">{app.dci} - {app.dosage}</div>
                            <div className="text-xs text-gray-500">üìÖ {new Date(app.dateSubmission).toLocaleDateString('fr-FR')}</div>
                            <div className="text-xs text-gray-500">üìÑ {app.documents} documents ({app.documentsVerified}/{app.documents} v√©rifi√©s)</div>
                            {app.arDocument && (
                                <div className="flex items-center space-x-1 text-purple-600 text-xs">
                                    <Icon name="check" className="w-3 h-3" />
                                    <span>AR t√©l√©vers√©</span>
                                </div>
                            )}
                        </div>
                        <div className="flex gap-2">
                            {showARButton && !app.arDocument && (
                                <button
                                    onClick={(e) => {
                                        e.stopPropagation();
                                        onUploadAR();
                                    }}
                                    className="flex-1 flex items-center justify-center space-x-1 bg-purple-600 hover:bg-purple-700 text-white px-2 py-1.5 rounded text-xs font-medium transition-colors"
                                >
                                    <Icon name="file-up" className="w-3 h-3" />
                                    <span>Upload AR</span>
                                </button>
                            )}
                            <button
                                onClick={onView}
                                className="flex-1 flex items-center justify-center space-x-1 bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1.5 rounded text-xs transition-colors"
                            >
                                <Icon name="eye" className="w-3 h-3" />
                                <span>D√©tails</span>
                            </button>
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* Demo Banner */}
                    <div className="bg-gradient-to-r from-blue-600 to-blue-800 text-white py-2 px-4 text-center text-sm font-medium">
                        üè• Syst√®me e-Homologation DPML - D√©monstration Interactive
                    </div>

                    {/* Notification */}
                    {notification && (
                        <div className={`fixed top-20 right-4 z-50 px-6 py-3 rounded-lg shadow-lg animate-fade-in ${
                            notification.type === 'success' ? 'bg-green-500' : 'bg-red-500'
                        } text-white`}>
                            {notification.message}
                        </div>
                    )}

                    {/* Header */}
                    <div className="bg-white border-b shadow-sm">
                        <div className="max-w-7xl mx-auto px-4 py-3">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center space-x-3">
                                    <div className="bg-blue-600 text-white px-4 py-2 rounded-lg font-bold text-lg">
                                        DPML
                                    </div>
                                    <div>
                                        <div className="font-semibold text-gray-900">DPML - MINSANTE</div>
                                        <div className="text-xs text-gray-500">Direction de la Pharmacie, du M√©dicament et des Laboratoires</div>
                                    </div>
                                </div>
                                <div className="flex items-center space-x-2 bg-gray-100 px-4 py-2 rounded-lg">
                                    <Icon name="user" className="w-4 h-4 text-gray-600" />
                                    <span className="text-sm font-medium text-gray-700">Secr√©tariat DPML</span>
                                    <Icon name="log-out" className="w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600" />
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Navigation Tabs */}
                    <div className="bg-white border-b">
                        <div className="max-w-7xl mx-auto px-4">
                            <div className="flex space-x-1">
                                <button
                                    onClick={() => setActiveView('representant')}
                                    className={`px-6 py-3 font-medium text-sm transition-colors ${
                                        activeView === 'representant'
                                            ? 'text-blue-600 border-b-2 border-blue-600 bg-blue-50'
                                            : 'text-gray-600 hover:text-gray-900 hover:bg-gray-50'
                                    }`}
                                >
                                    üìã Repr√©sentant
                                </button>
                                <button
                                    onClick={() => setActiveView('secretariat')}
                                    className={`px-6 py-3 font-medium text-sm transition-colors ${
                                        activeView === 'secretariat'
                                            ? 'text-blue-600 border-b-2 border-blue-600 bg-blue-50'
                                            : 'text-gray-600 hover:text-gray-900 hover:bg-gray-50'
                                    }`}
                                >
                                    üìë Secr√©tariat
                                </button>
                                <button
                                    onClick={() => setActiveView('directeur')}
                                    className={`px-6 py-3 font-medium text-sm transition-colors ${
                                        activeView === 'directeur'
                                            ? 'text-blue-600 border-b-2 border-blue-600 bg-blue-50'
                                            : 'text-gray-600 hover:text-gray-900 hover:bg-gray-50'
                                    }`}
                                >
                                    üìä Directeur
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Main Content */}
                    <div className="max-w-7xl mx-auto px-4 py-6">
                        {/* SECR√âTARIAT VIEW */}
                        {activeView === 'secretariat' && (
                            <div className="space-y-6 animate-fade-in">
                                <h2 className="text-2xl font-bold text-gray-900">Gestion des Demandes</h2>
                                
                                <div className="grid grid-cols-1 lg:grid-cols-3 gap-4">
                                    {/* Soumis Column */}
                                    <div className="space-y-3">
                                        <div className="flex items-center justify-between bg-blue-50 px-3 py-2 rounded-lg">
                                            <h3 className="font-semibold text-blue-900">Soumis</h3>
                                            <span className="bg-blue-200 text-blue-900 px-2 py-1 rounded-full text-xs font-bold">
                                                {statusCounts['Soumis']}
                                            </span>
                                        </div>
                                        {getApplicationsByStatus('Soumis').map(app => (
                                            <ApplicationCard 
                                                key={app.id} 
                                                app={app} 
                                                onView={() => {
                                                    setSelectedApplication(app);
                                                    setShowDetailModal(true);
                                                }}
                                                onUploadAR={() => handleUploadAR(app)}
                                                showARButton={true}
                                            />
                                        ))}
                                    </div>

                                    {/* En attente AR Column */}
                                    <div className="space-y-3">
                                        <div className="flex items-center justify-between bg-purple-50 px-3 py-2 rounded-lg">
                                            <h3 className="font-semibold text-purple-900">En attente AR</h3>
                                            <span className="bg-purple-200 text-purple-900 px-2 py-1 rounded-full text-xs font-bold">
                                                {statusCounts['En attente AR']}
                                            </span>
                                        </div>
                                        {getApplicationsByStatus('En attente AR').map(app => (
                                            <ApplicationCard 
                                                key={app.id} 
                                                app={app} 
                                                onView={() => {
                                                    setSelectedApplication(app);
                                                    setShowDetailModal(true);
                                                }}
                                                onUploadAR={() => handleUploadAR(app)}
                                                showARButton={true}
                                            />
                                        ))}
                                    </div>

                                    {/* V√©rification en cours Column */}
                                    <div className="space-y-3">
                                        <div className="flex items-center justify-between bg-yellow-50 px-3 py-2 rounded-lg">
                                            <h3 className="font-semibold text-yellow-900">V√©rification en cours</h3>
                                            <span className="bg-yellow-200 text-yellow-900 px-2 py-1 rounded-full text-xs font-bold">
                                                {statusCounts['V√©rification en cours']}
                                            </span>
                                        </div>
                                        {getApplicationsByStatus('V√©rification en cours').map(app => (
                                            <ApplicationCard 
                                                key={app.id} 
                                                app={app} 
                                                onView={() => {
                                                    setSelectedApplication(app);
                                                    setShowDetailModal(true);
                                                }}
                                                showARButton={false}
                                            />
                                        ))}
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 lg:grid-cols-3 gap-4 mt-6">
                                    {/* Commission CNM, Approuv√©, Rejet√© columns */}
                                    <div className="space-y-3">
                                        <div className="flex items-center justify-between bg-indigo-50 px-3 py-2 rounded-lg">
                                            <h3 className="font-semibold text-indigo-900">Commission CNM</h3>
                                            <span className="bg-indigo-200 text-indigo-900 px-2 py-1 rounded-full text-xs font-bold">
                                                {statusCounts['Commission CNM']}
                                            </span>
                                        </div>
                                        {getApplicationsByStatus('Commission CNM').map(app => (
                                            <ApplicationCard 
                                                key={app.id} 
                                                app={app} 
                                                onView={() => {
                                                    setSelectedApplication(app);
                                                    setShowDetailModal(true);
                                                }}
                                                showARButton={false}
                                            />
                                        ))}
                                    </div>

                                    <div className="space-y-3">
                                        <div className="flex items-center justify-between bg-green-50 px-3 py-2 rounded-lg">
                                            <h3 className="font-semibold text-green-900">Approuv√©</h3>
                                            <span className="bg-green-200 text-green-900 px-2 py-1 rounded-full text-xs font-bold">
                                                {statusCounts['Approuv√©']}
                                            </span>
                                        </div>
                                        {getApplicationsByStatus('Approuv√©').map(app => (
                                            <ApplicationCard 
                                                key={app.id} 
                                                app={app} 
                                                onView={() => {
                                                    setSelectedApplication(app);
                                                    setShowDetailModal(true);
                                                }}
                                                showARButton={false}
                                            />
                                        ))}
                                    </div>

                                    <div className="space-y-3">
                                        <div className="flex items-center justify-between bg-red-50 px-3 py-2 rounded-lg">
                                            <h3 className="font-semibold text-red-900">Rejet√©</h3>
                                            <span className="bg-red-200 text-red-900 px-2 py-1 rounded-full text-xs font-bold">
                                                {statusCounts['Rejet√©']}
                                            </span>
                                        </div>
                                        {getApplicationsByStatus('Rejet√©').map(app => (
                                            <ApplicationCard 
                                                key={app.id} 
                                                app={app} 
                                                onView={() => {
                                                    setSelectedApplication(app);
                                                    setShowDetailModal(true);
                                                }}
                                                showARButton={false}
                                            />
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* REPR√âSENTANT VIEW */}
                        {activeView === 'representant' && (
                            <div className="space-y-6 animate-fade-in">
                                <div className="flex items-center justify-between">
                                    <h2 className="text-2xl font-bold text-gray-900">Mes Demandes</h2>
                                    <button
                                        onClick={() => setShowNewDemandModal(true)}
                                        className="flex items-center space-x-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors"
                                    >
                                        <Icon name="plus" className="w-5 h-5" />
                                        <span>Nouvelle Demande</span>
                                    </button>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    {currentUserApplications.map(app => (
                                        <div key={app.id} className="bg-white rounded-lg border shadow-sm hover:shadow-md transition-shadow p-4">
                                            <div className="flex items-start justify-between mb-3">
                                                <div>
                                                    <div className="text-xs font-semibold text-blue-600 mb-1">{app.ammNumber}</div>
                                                    <div className="font-semibold text-gray-900">{app.dci}</div>
                                                    <div className="text-sm text-gray-600">{app.nomCommercial}</div>
                                                </div>
                                                <span className={`px-2 py-1 rounded text-xs font-medium border ${statusColors[app.status]}`}>
                                                    {app.status}
                                                </span>
                                            </div>
                                            <div className="space-y-1 text-sm text-gray-600">
                                                <div>üìÖ {new Date(app.dateSubmission).toLocaleDateString('fr-FR')}</div>
                                                <div>üíä {app.formePharm} - {app.dosage}</div>
                                                <div>üè≠ {app.fabricant}</div>
                                                {app.arDocument && (
                                                    <div className="flex items-center space-x-1 text-green-600">
                                                        <Icon name="check" className="w-3 h-3" />
                                                        <span className="text-xs">AR re√ßu</span>
                                                    </div>
                                                )}
                                            </div>
                                            <button
                                                onClick={() => {
                                                    setSelectedApplication(app);
                                                    setShowDetailModal(true);
                                                }}
                                                className="mt-3 w-full flex items-center justify-center space-x-2 bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded text-sm transition-colors"
                                            >
                                                <Icon name="eye" className="w-4 h-4" />
                                                <span>Voir d√©tails</span>
                                            </button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* DIRECTEUR VIEW */}
                        {activeView === 'directeur' && (
                            <div className="space-y-6 animate-fade-in">
                                <h2 className="text-2xl font-bold text-gray-900">Tableau de Bord Analytique</h2>

                                {/* KPI Cards */}
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                    <div className="bg-white rounded-lg border shadow-sm p-4">
                                        <div className="flex items-center justify-between mb-2">
                                            <div className="text-sm text-gray-600">Demandes Soumises</div>
                                            <Icon name="trending-up" className="w-5 h-5 text-green-500" />
                                        </div>
                                        <div className="text-3xl font-bold text-gray-900">{totalSubmitted}</div>
                                        <div className="text-xs text-green-600 mt-1">+12% ce mois</div>
                                    </div>

                                    <div className="bg-white rounded-lg border shadow-sm p-4">
                                        <div className="flex items-center justify-between mb-2">
                                            <div className="text-sm text-gray-600">D√©lai Moyen</div>
                                            <Icon name="clock" className="w-5 h-5 text-blue-500" />
                                        </div>
                                        <div className="text-3xl font-bold text-gray-900">18 jours</div>
                                        <div className="w-full bg-gray-200 rounded-full h-2 mt-2">
                                            <div className="bg-blue-500 h-2 rounded-full" style={{width: '60%'}}></div>
                                        </div>
                                    </div>

                                    <div className="bg-white rounded-lg border shadow-sm p-4">
                                        <div className="flex items-center justify-between mb-2">
                                            <div className="text-sm text-gray-600">Taux d'Approbation</div>
                                            <Icon name="check" className="w-5 h-5 text-green-500" />
                                        </div>
                                        <div className="text-3xl font-bold text-gray-900">{approvalRate}%</div>
                                        <div className="w-full bg-gray-200 rounded-full h-2 mt-2">
                                            <div className="bg-green-500 h-2 rounded-full" style={{width: `${approvalRate}%`}}></div>
                                        </div>
                                    </div>

                                    <div className="bg-white rounded-lg border shadow-sm p-4">
                                        <div className="flex items-center justify-between mb-2">
                                            <div className="text-sm text-gray-600">En Attente</div>
                                            <Icon name="alert-triangle" className={`w-5 h-5 ${pending > 10 ? 'text-red-500' : 'text-orange-500'}`} />
                                        </div>
                                        <div className="text-3xl font-bold text-gray-900">{pending}</div>
                                        <div className={`text-xs mt-1 ${pending > 10 ? 'text-red-600' : 'text-orange-600'}`}>
                                            {pending > 10 ? 'Attention!' : 'Normal'}
                                        </div>
                                    </div>
                                </div>

                                {/* Charts */}
                                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                    {/* Bar Chart */}
                                    <div className="bg-white rounded-lg border shadow-sm p-6">
                                        <h3 className="text-lg font-semibold text-gray-900 mb-4">Demandes par Statut</h3>
                                        <div className="space-y-3">
                                            {Object.entries(statusCounts).map(([status, count]) => (
                                                <div key={status}>
                                                    <div className="flex items-center justify-between text-sm mb-1">
                                                        <span className="text-gray-600">{status}</span>
                                                        <span className="font-semibold text-gray-900">{count}</span>
                                                    </div>
                                                    <div className="w-full bg-gray-200 rounded-full h-3">
                                                        <div 
                                                            className="bg-blue-500 h-3 rounded-full transition-all duration-500"
                                                            style={{width: `${(count / totalSubmitted) * 100}%`}}
                                                        ></div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>

                                    {/* Line Chart Simulation */}
                                    <div className="bg-white rounded-lg border shadow-sm p-6">
                                        <h3 className="text-lg font-semibold text-gray-900 mb-4">√âvolution Mensuelle</h3>
                                        <div className="flex items-end justify-between h-48 px-4">
                                            {['Juil', 'Ao√ªt', 'Sept', 'Oct', 'Nov', 'D√©c'].map((month, idx) => {
                                                const height = [45, 55, 60, 70, 75, 85][idx];
                                                return (
                                                    <div key={month} className="flex flex-col items-center space-y-2 flex-1">
                                                        <div className="relative w-full flex items-end justify-center" style={{height: '180px'}}>
                                                            <div 
                                                                className="w-12 bg-blue-500 rounded-t hover:bg-blue-600 transition-colors cursor-pointer"
                                                                style={{height: `${height}%`}}
                                                                title={`${month}: ${Math.round(height/10)} demandes`}
                                                            ></div>
                                                        </div>
                                                        <span className="text-xs text-gray-600">{month}</span>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                </div>

                                {/* Market Alerts Table */}
                                <div className="bg-white rounded-lg border shadow-sm p-6">
                                    <div className="flex items-center space-x-2 mb-4">
                                        <Icon name="alert-triangle" className="w-5 h-5 text-orange-500" />
                                        <h3 className="text-lg font-semibold text-gray-900">Alertes Surcharge March√©</h3>
                                    </div>
                                    <div className="overflow-x-auto">
                                        <table className="w-full">
                                            <thead>
                                                <tr className="border-b bg-gray-50">
                                                    <th className="px-4 py-3 text-left text-sm font-semibold text-gray-900">DCI</th>
                                                    <th className="px-4 py-3 text-left text-sm font-semibold text-gray-900">R√©f√©rences</th>
                                                    <th className="px-4 py-3 text-left text-sm font-semibold text-gray-900">PGHT Moyen</th>
                                                    <th className="px-4 py-3 text-left text-sm font-semibold text-gray-900">Statut</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {marketAlerts.map((alert, idx) => (
                                                    <tr key={idx} className="border-b hover:bg-gray-50">
                                                        <td className="px-4 py-3 text-sm text-gray-900">{alert.dci}</td>
                                                        <td className="px-4 py-3 text-sm text-gray-600">{alert.references}</td>
                                                        <td className="px-4 py-3 text-sm text-gray-600">{alert.avgPGHT.toLocaleString()} FCFA</td>
                                                        <td className="px-4 py-3">
                                                            <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
                                                                alert.status === 'green' ? 'bg-green-100 text-green-800' :
                                                                alert.status === 'orange' ? 'bg-orange-100 text-orange-800' :
                                                                'bg-red-100 text-red-800'
                                                            }`}>
                                                                {alert.status === 'green' ? '‚úì Normal' :
                                                                 alert.status === 'orange' ? '‚ö† Surveillance' :
                                                                 'üî¥ Surcharge'}
                                                            </span>
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>

                    {/* New Demand Modal */}
                    {showNewDemandModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                                <div className="sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between">
                                    <h3 className="text-xl font-bold text-gray-900">Nouvelle Demande AMM</h3>
                                    <button onClick={() => setShowNewDemandModal(false)} className="text-gray-400 hover:text-gray-600">
                                        <Icon name="x" className="w-6 h-6" />
                                    </button>
                                </div>
                                
                                <form onSubmit={handleSubmitNewDemand} className="p-6 space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Type de demande *</label>
                                        <select
                                            value={newDemand.type}
                                            onChange={(e) => setNewDemand({...newDemand, type: e.target.value})}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            required
                                        >
                                            <option value="Nouvelle AMM">Nouvelle AMM</option>
                                            <option value="Renouvellement">Renouvellement</option>
                                            <option value="Variation Majeure">Variation Majeure</option>
                                        </select>
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">DCI *</label>
                                            <input
                                                type="text"
                                                value={newDemand.dci}
                                                onChange={(e) => setNewDemand({...newDemand, dci: e.target.value})}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                                placeholder="Ex: Parac√©tamol"
                                                required
                                            />
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Forme pharmaceutique *</label>
                                            <select
                                                value={newDemand.formePharm}
                                                onChange={(e) => setNewDemand({...newDemand, formePharm: e.target.value})}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                                required
                                            >
                                                <option value="Comprim√©">Comprim√©</option>
                                                <option value="G√©lule">G√©lule</option>
                                                <option value="Solution injectable">Solution injectable</option>
                                                <option value="Suspension">Suspension</option>
                                                <option value="Sirop">Sirop</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Dosage *</label>
                                        <input
                                            type="text"
                                            value={newDemand.dosage}
                                            onChange={(e) => setNewDemand({...newDemand, dosage: e.target.value})}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            placeholder="Ex: 500mg"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Nom commercial *</label>
                                        <input
                                            type="text"
                                            value={newDemand.nomCommercial}
                                            onChange={(e) => setNewDemand({...newDemand, nomCommercial: e.target.value})}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            placeholder="Ex: Doliprane"
                                            required
                                        />
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Fabricant *</label>
                                            <input
                                                type="text"
                                                value={newDemand.fabricant}
                                                onChange={(e) => setNewDemand({...newDemand, fabricant: e.target.value})}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                                placeholder="Ex: Sanofi"
                                                required
                                            />
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Pays d'origine *</label>
                                            <input
                                                type="text"
                                                value={newDemand.paysOrigine}
                                                onChange={(e) => setNewDemand({...newDemand, paysOrigine: e.target.value})}
                                                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                                placeholder="Ex: France"
                                                required
                                            />
                                        </div>
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">PGHT propos√© (FCFA) *</label>
                                        <input
                                            type="number"
                                            value={newDemand.pght}
                                            onChange={(e) => setNewDemand({...newDemand, pght: e.target.value})}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            placeholder="Ex: 2500"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Documents √† t√©l√©verser *</label>
                                        <div className="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-500 transition-colors">
                                            <input
                                                type="file"
                                                multiple
                                                onChange={handleFileUpload}
                                                className="hidden"
                                                id="file-upload"
                                                accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
                                            />
                                            <label htmlFor="file-upload" className="cursor-pointer">
                                                <Icon name="upload" className="w-12 h-12 mx-auto mb-2 text-gray-400" />
                                                <div className="text-sm text-gray-600">
                                                    Cliquez pour t√©l√©verser ou glissez-d√©posez
                                                </div>
                                                <div className="text-xs text-gray-500 mt-1">
                                                    PDF, DOC, DOCX, JPG, PNG (Max 10MB par fichier)
                                                </div>
                                            </label>
                                        </div>
                                        {uploadedFiles.length > 0 && (
                                            <div className="mt-3 space-y-2">
                                                <div className="text-sm font-medium text-green-600">
                                                    ‚úì {uploadedFiles.length} document(s) t√©l√©vers√©(s)
                                                </div>
                                                {uploadedFiles.map((file, idx) => (
                                                    <div key={idx} className="flex items-center space-x-2 text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded">
                                                        <Icon name="file-text" className="w-4 h-4" />
                                                        <span>{file.name}</span>
                                                        <span className="text-xs text-gray-400">({(file.size / 1024).toFixed(1)} KB)</span>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>

                                    <div className="flex items-center space-x-3 pt-4 border-t">
                                        <button
                                            type="button"
                                            onClick={() => setShowNewDemandModal(false)}
                                            className="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
                                        >
                                            Annuler
                                        </button>
                                        <button
                                            type="submit"
                                            className="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                                        >
                                            Soumettre la demande
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}

                    {/* Detail Modal */}
                    {showDetailModal && selectedApplication && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto">
                                <div className="sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between">
                                    <div>
                                        <h3 className="text-xl font-bold text-gray-900">{selectedApplication.ammNumber}</h3>
                                        <p className="text-sm text-gray-600">{selectedApplication.dci} - {selectedApplication.nomCommercial}</p>
                                    </div>
                                    <button onClick={() => setShowDetailModal(false)} className="text-gray-400 hover:text-gray-600">
                                        <Icon name="x" className="w-6 h-6" />
                                    </button>
                                </div>
                                
                                <div className="p-6 space-y-6">
                                    {/* Status Badge */}
                                    <div className="flex items-center justify-between">
                                        <span className={`px-4 py-2 rounded-lg text-sm font-medium border ${statusColors[selectedApplication.status]}`}>
                                            {selectedApplication.status}
                                        </span>
                                    </div>

                                    {/* Application Details */}
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <div className="text-xs font-medium text-gray-500 mb-1">Type de demande</div>
                                            <div className="text-sm text-gray-900">{selectedApplication.type}</div>
                                        </div>
                                        <div>
                                            <div className="text-xs font-medium text-gray-500 mb-1">Date de soumission</div>
                                            <div className="text-sm text-gray-900">{new Date(selectedApplication.dateSubmission).toLocaleDateString('fr-FR')}</div>
                                        </div>
                                        <div>
                                            <div className="text-xs font-medium text-gray-500 mb-1">DCI</div>
                                            <div className="text-sm text-gray-900">{selectedApplication.dci}</div>
                                        </div>
                                        <div>
                                            <div className="text-xs font-medium text-gray-500 mb-1">Forme pharmaceutique</div>
                                            <div className="text-sm text-gray-900">{selectedApplication.formePharm}</div>
                                        </div>
                                        <div>
                                            <div className="text-xs font-medium text-gray-500 mb-1">Dosage</div>
                                            <div className="text-sm text-gray-900">{selectedApplication.dosage}</div>
                                        </div>
                                        <div>
                                            <div className="text-xs font-medium text-gray-500 mb-1">Nom commercial</div>
                                            <div className="text-sm text-gray-900">{selectedApplication.nomCommercial}</div>
                                        </div>
                                        <div>
                                            <div className="text-xs font-medium text-gray-500 mb-1">Fabricant</div>
                                            <div className="text-sm text-gray-900">{selectedApplication.fabricant}</div>
                                        </div>
                                        <div>
                                            <div className="text-xs font-medium text-gray-500 mb-1">Pays d'origine</div>
                                            <div className="text-sm text-gray-900">{selectedApplication.paysOrigine}</div>
                                        </div>
                                        <div>
                                            <div className="text-xs font-medium text-gray-500 mb-1">PGHT propos√©</div>
                                            <div className="text-sm text-gray-900">{selectedApplication.pght.toLocaleString()} FCFA</div>
                                        </div>
                                        {selectedApplication.dateAR && (
                                            <div>
                                                <div className="text-xs font-medium text-gray-500 mb-1">Date AR</div>
                                                <div className="text-sm text-gray-900">{new Date(selectedApplication.dateAR).toLocaleDateString('fr-FR')}</div>
                                            </div>
                                        )}
                                    </div>

                                    {/* AR Document */}
                                    {selectedApplication.arDocument && (
                                        <div className="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                            <div className="flex items-center justify-between">
                                                <div className="flex items-center space-x-3">
                                                    <Icon name="file-text" className="w-8 h-8 text-purple-600" />
                                                    <div>
                                                        <div className="text-sm font-medium text-purple-900">Accus√© de R√©ception</div>
                                                        <div className="text-xs text-purple-700">{selectedApplication.arDocument}</div>
                                                    </div>
                                                </div>
                                                <button className="flex items-center space-x-1 px-3 py-1 bg-purple-600 hover:bg-purple-700 text-white rounded text-xs transition-colors">
                                                    <Icon name="download" className="w-3 h-3" />
                                                    <span>T√©l√©charger</span>
                                                </button>
                                            </div>
                                        </div>
                                    )}

                                    {/* Representative Info */}
                                    <div className="bg-gray-50 rounded-lg p-4">
                                        <div className="text-sm font-medium text-gray-700 mb-2">Informations Repr√©sentant</div>
                                        <div className="space-y-1 text-sm text-gray-600">
                                            <div><strong>Nom:</strong> {selectedApplication.representative}</div>
                                            <div><strong>Soci√©t√©:</strong> {selectedApplication.company}</div>
                                            <div><strong>Email:</strong> {selectedApplication.email}</div>
                                        </div>
                                    </div>

                                    {/* Documents */}
                                    <div>
                                        <div className="text-sm font-medium text-gray-700 mb-2">Documents ({selectedApplication.documents}/7)</div>
                                        <div className="space-y-2">
                                            {['Formulaire AMM', 'Certificat d\'analyse', 'Dossier technique', 'Autorisation fabricant', '√âchantillons', 'R√©sum√© des caract√©ristiques', 'Notice patient'].map((doc, idx) => (
                                                <div key={idx} className="flex items-center justify-between bg-gray-50 px-3 py-2 rounded">
                                                    <div className="flex items-center space-x-2">
                                                        <Icon name="file-text" className="w-4 h-4 text-gray-400" />
                                                        <span className="text-sm text-gray-700">{doc}</span>
                                                    </div>
                                                    {idx < selectedApplication.documentsVerified ? (
                                                        <Icon name="check" className="w-5 h-5 text-green-600" />
                                                    ) : (
                                                        <div className="w-5 h-5 border-2 border-gray-300 rounded"></div>
                                                    )}
                                                </div>
                                            ))}
                                        </div>
                                    </div>

                                    {/* Rejection Reason */}
                                    {selectedApplication.status === 'Rejet√©' && selectedApplication.rejectionReason && (
                                        <div className="bg-red-50 border border-red-200 rounded-lg p-4">
                                            <div className="text-sm font-medium text-red-800 mb-1">Raison du rejet</div>
                                            <div className="text-sm text-red-700">{selectedApplication.rejectionReason}</div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    {/* AR Upload Modal */}
                    {showARUploadModal && selectedApplication && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-lg shadow-xl max-w-lg w-full">
                                <div className="bg-purple-600 text-white px-6 py-4 rounded-t-lg flex items-center justify-between">
                                    <div className="flex items-center space-x-2">
                                        <Icon name="file-up" className="w-6 h-6" />
                                        <h3 className="text-xl font-bold">T√©l√©verser l'AR</h3>
                                    </div>
                                    <button onClick={() => setShowARUploadModal(false)} className="text-white hover:text-gray-200">
                                        <Icon name="x" className="w-6 h-6" />
                                    </button>
                                </div>
                                
                                <div className="p-6 space-y-4">
                                    <div className="bg-gray-50 rounded-lg p-4 border">
                                        <div className="text-sm font-medium text-gray-700 mb-2">Demande concern√©e</div>
                                        <div className="space-y-1 text-sm">
                                            <div><strong>N¬∞:</strong> {selectedApplication.ammNumber}</div>
                                            <div><strong>DCI:</strong> {selectedApplication.dci}</div>
                                            <div><strong>Repr√©sentant:</strong> {selectedApplication.representative}</div>
                                            <div><strong>Email:</strong> {selectedApplication.email}</div>
                                        </div>
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Document AR sign√© (PDF) *
                                        </label>
                                        <div className="border-2 border-dashed border-purple-300 rounded-lg p-8 text-center hover:border-purple-500 transition-colors bg-purple-50">
                                            <input
                                                type="file"
                                                onChange={handleARFileUpload}
                                                className="hidden"
                                                id="ar-upload"
                                                accept=".pdf"
                                            />
                                            <label htmlFor="ar-upload" className="cursor-pointer">
                                                <Icon name="file-up" className="w-16 h-16 mx-auto mb-3 text-purple-500" />
                                                <div className="text-sm font-medium text-gray-700">
                                                    Cliquez pour t√©l√©verser l'AR sign√©
                                                </div>
                                                <div className="text-xs text-gray-500 mt-2">
                                                    Format PDF uniquement (Max 5MB)
                                                </div>
                                            </label>
                                        </div>
                                        {arFile && (
                                            <div className="mt-3 flex items-center space-x-2 text-sm text-green-600 bg-green-50 px-4 py-3 rounded-lg border border-green-200">
                                                <Icon name="check" className="w-5 h-5" />
                                                <div>
                                                    <div className="font-medium">{arFile.name}</div>
                                                    <div className="text-xs">({(arFile.size / 1024).toFixed(1)} KB)</div>
                                                </div>
                                            </div>
                                        )}
                                    </div>

                                    <div className="bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-800">
                                        <strong>Note:</strong> Une fois t√©l√©vers√©, l'AR sera automatiquement envoy√© par email au repr√©sentant et la demande passera en "V√©rification en cours".
                                    </div>

                                    <div className="flex items-center space-x-3 pt-4 border-t">
                                        <button
                                            type="button"
                                            onClick={() => setShowARUploadModal(false)}
                                            className="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
                                        >
                                            Annuler
                                        </button>
                                        <button
                                            onClick={handleSubmitAR}
                                            className="flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                                            disabled={!arFile}
                                        >
                                            <Icon name="send" className="w-4 h-4" />
                                            <span>T√©l√©verser et envoyer</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<EHomologationDPML />);
    </script>
</body>
</html>
